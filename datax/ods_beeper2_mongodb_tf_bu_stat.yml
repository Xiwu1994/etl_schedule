job:
  content:
  - reader:
      name: mongodbreader
      parameter:
        address:
        - '${mongodb_ip}:${mongodb_port}'
        userName: ''
        userPassword: ''
        dbName: '${mongodb_database}'
        collectionName: tf_bu_stats
        query: '{date: {$gte: "${year_month}-01", $lt: "${next_year_month}-01"}}'
        column:
        - name: cuid
          type: long
        - name: date
          type: string
        - name: check_in_total_count
          type: long
        - name: sop_check_in_count
          type: long
        - name: subsidy_total_price
          type: long
        - name: total_dprice
          type: long
        - name: total_cprice
          type: long
        - name: total_cprice_tax
          type: long
        - name: sop_total_price
          type: long
        - name: welfare_total_price
          type: long
        - name: cargo_insurance_price
          type: long
        - name: cargo_insurance_price_tax
          type: long
        - name: task_total_count
          type: long
        - name: task_done_count
          type: long
        - name: task_abandoned_count
          type: long
        - name: task_expired_count
          type: long
        - name: task_done_min_price
          type: long
        - name: task_done_max_price
          type: long
        - name: stats_data_by_eets.task_total_count
          type: long
        - name: stats_data_by_eets.task_done_count
          type: long
        - name: stats_data_by_eets.task_abandoned_count
          type: long
        - name: stats_data_by_eets.task_expired_count
          type: long
        - name: stats_data_by_eets.task_no_selection_count
          type: long
        - name: stats_data_by_eets.main_task_total_count
          type: long
        - name: stats_data_by_eets.main_task_done_count
          type: long
        - name: stats_data_by_eets.main_task_abandoned_count
          type: long
        - name: stats_data_by_eets.main_task_expired_count
          type: long
        - name: stats_data_by_eets.main_task_no_selection_count
          type: long
        - name: stats_data_by_eets.tmp_task_total_count
          type: long
        - name: stats_data_by_eets.tmp_task_done_count
          type: long
        - name: stats_data_by_eets.tmp_task_abandoned_count
          type: long
        - name: stats_data_by_eets.tmp_task_expired_count
          type: long
        - name: stats_data_by_eets.tmp_task_no_selection_count
          type: long
    writer:
      name: odpswriter
      parameter:
        odpsServer: http://service.odps.aliyun.com/api
        accessId: '${odps_access_id}'
        accessKey: '${odps_access_key}'
        project: '${warehouse_project}'
        table: ods_beeper2_mongodb_tf_bu_stat
        partition: 'month=${year_month}'
        truncate: true
        tunnelServer: ''
        column:
        - cuid
        - date_
        - check_in_total_count
        - sop_check_in_count
        - subsidy_total_price
        - total_dprice
        - total_cprice
        - total_cprice_tax
        - sop_total_price
        - welfare_total_price
        - cargo_insurance_price
        - cargo_insurance_price_tax
        - task_total_count
        - task_done_count
        - task_abandoned_count
        - task_expired_count
        - task_done_min_price
        - task_done_max_price
        - stats_data_by_eets__task_total_count
        - stats_data_by_eets__task_done_count
        - stats_data_by_eets__task_abandoned_count
        - stats_data_by_eets__task_expired_count
        - stats_data_by_eets__task_no_selection_count
        - stats_data_by_eets__main_task_total_count
        - stats_data_by_eets__main_task_done_count
        - stats_data_by_eets__main_task_abandoned_count
        - stats_data_by_eets__main_task_expired_count
        - stats_data_by_eets__main_task_no_selection_count
        - stats_data_by_eets__tmp_task_total_count
        - stats_data_by_eets__tmp_task_done_count
        - stats_data_by_eets__tmp_task_abandoned_count
        - stats_data_by_eets__tmp_task_expired_count
        - stats_data_by_eets__tmp_task_no_selection_count
  setting:
    speed:
      channel: '1'
